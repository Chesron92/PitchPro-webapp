import{d as M,u as C,r as n,j as e}from"./react-vendor-wqxTS4Az.js";import{u as S,c as D}from"./index-1iGq18Ep.js";import{S as b}from"./Spinner-CoP5_FFj.js";import{H as L}from"./Header-Pjeg2nCk.js";import"./firebase-firestore-CCnivBKz.js";import"./firebase-app-CzzSlWfx.js";const B=()=>{const{chatId:c}=M(),{currentUser:t}=S(),i=C(),{chats:h,activeChat:r,messages:d,loadingChats:v,loadingMessages:N,error:u,sendMessage:y,setActiveChatById:g}=D(),[o,m]=n.useState(""),f=n.useRef(null),p=n.useRef(null);if(n.useEffect(()=>{t||i("/login")},[t,i]),n.useEffect(()=>{c&&g(c)},[c,g]),n.useEffect(()=>{var s;(s=f.current)==null||s.scrollIntoView({behavior:"smooth"})},[d]),n.useEffect(()=>{var s;r&&((s=p.current)==null||s.focus())},[d.length,r]),v)return e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(b,{})});const w=async s=>{if(s.preventDefault(),!o.trim()||!r)return;const a=o.trim();m("");try{await y(r.id,a)}catch(l){console.error("Fout bij het versturen van bericht:",l),m(a)}},k=s=>{i(`/messages/${s}`)},j=s=>{if(!s)return"";const a=s.toDate(),l=new Date,x=new Date(l);return x.setDate(x.getDate()-1),a.toDateString()===l.toDateString()?a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):a.toDateString()===x.toDateString()?"Gisteren":a.toLocaleDateString()};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(L,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Berichten"}),e.jsxs("button",{onClick:()=>i("/dashboard"),className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Terug naar Dashboard"]})]}),u&&e.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4",children:u}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-white rounded-lg shadow-lg overflow-hidden min-h-[70vh]",children:[e.jsxs("div",{className:"md:w-1/3 border-r",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b",children:e.jsx("h2",{className:"font-semibold text-lg",children:"Gesprekken"})}),e.jsx("div",{className:"overflow-y-auto h-[calc(70vh-4rem)]",children:h.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Geen berichten gevonden. Start een gesprek via het profiel van een kandidaat of recruiter."}):h.map(s=>{var a,l;return e.jsx("div",{className:`p-4 border-b hover:bg-gray-50 cursor-pointer ${(r==null?void 0:r.id)===s.id?"bg-blue-50":""}`,onClick:()=>k(s.id),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[s.otherUser.photoURL?e.jsx("img",{src:s.otherUser.photoURL,alt:s.otherUser.displayName,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center text-lg font-medium text-gray-600",children:s.otherUser.displayName.substring(0,1).toUpperCase()}),typeof s.unreadCount=="number"?s.unreadCount>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:s.unreadCount}):(((a=s.unreadCount)==null?void 0:a[(t==null?void 0:t.uid)||""])||0)>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:((l=s.unreadCount)==null?void 0:l[(t==null?void 0:t.uid)||""])||0})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium truncate",children:s.otherUser.displayName}),s.lastMessageTimestamp&&e.jsx("span",{className:"text-xs text-gray-500",children:j(s.lastMessageTimestamp)})]}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:s.lastMessage?s.lastMessage:"Geen berichten"})]})]})},s.id)})})]}),e.jsx("div",{className:"md:w-2/3 flex flex-col",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-gray-50 border-b flex items-center gap-3",children:[r.otherUser.photoURL?e.jsx("img",{src:r.otherUser.photoURL,alt:r.otherUser.displayName,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-md font-medium text-gray-600",children:r.otherUser.displayName.substring(0,1).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold",children:r.otherUser.displayName}),e.jsx("p",{className:"text-sm text-gray-500",children:r.otherUser.role})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 h-[calc(70vh-12rem)]",children:[N?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(b,{})}):d.length===0?e.jsx("div",{className:"text-center text-gray-500 mt-10",children:"Geen berichten. Stuur een bericht om het gesprek te starten."}):d.map(s=>e.jsx("div",{className:`flex ${s.senderId===(t==null?void 0:t.uid)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-3 rounded-lg ${s.senderId===(t==null?void 0:t.uid)?"bg-blue-500 text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[e.jsx("p",{children:s.text}),e.jsxs("div",{className:`text-xs mt-1 ${s.senderId===(t==null?void 0:t.uid)?"text-blue-100":"text-gray-500"}`,children:[j(s.timestamp),s.senderId===(t==null?void 0:t.uid)&&e.jsx("span",{className:"ml-1",children:s.read?" â€¢ Gelezen":""})]})]})},s.id)),e.jsx("div",{ref:f})]}),e.jsx("form",{onSubmit:w,className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:p,type:"text",value:o,onChange:s=>m(s.target.value),placeholder:"Typ een bericht...",className:"flex-1 border rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",disabled:!o.trim(),className:"bg-blue-500 text-white rounded-full p-2 hover:bg-blue-600 disabled:opacity-50",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-10 text-center text-gray-500",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mb-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Geen actief gesprek"}),e.jsx("p",{children:"Selecteer een gesprek in de lijst links om berichten weer te geven."})]})})]})]})]})};export{B as default};
//# sourceMappingURL=Messages-D0tpFUW7.js.map

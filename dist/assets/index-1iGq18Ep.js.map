{"version":3,"mappings":"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","names":["isJobSeeker","user","isRecruiter","getUserRole","firebaseConfig","define_process_env_default","appInstance","authInstance","dbInstance","storageInstance","analyticsInstance","getFirebaseApp","initializeApp","n","getFirebaseAuth","app","getAuth","getFirestore","fsGetFirestore","__vitePreload","getStorage","fsGetStorage","getAnalytics","fsGetAnalytics","auth","db","storage","initializeServices","error","AuthContext","createContext","useAuth","context","useContext","AuthProvider","children","currentUser","setCurrentUser","useState","userProfile","setUserProfile","loading","setLoading","authError","setAuthError","normalizeUserData","userData","uid","role","userType","normalizedUser","_a","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","_m","_n","_o","_p","createUserProfile","userId","email","displayName","getFirestoreDB","doc","setDoc","userDocRef","baseUserData","register","password","createUserWithEmailAndPassword","updateProfile","profileData","login","signInWithEmailAndPassword","logout","signOut","resetPassword","sendPasswordResetEmail","loadUserProfile","getDoc","updateDoc","userDoc","rawUserData","normalizedUserData","userRole","refreshUserProfile","createOrUpdateProfile","useEffect","safetyTimer","cleanup","onAuthStateChanged","unsubscribe","cleanupFn","value","MessageContext","useMessages","MessageProvider","chats","setChats","activeChat","setActiveChat","messages","setMessages","loadingChats","setLoadingChats","loadingMessages","setLoadingMessages","setError","chatsRef","collection","q","query","where","orderBy","onSnapshot","snapshot","chatPromises","docSnapshot","chatData","otherUserId","id","unreadCount","validChats","chat","err","messagesRef","messagesData","sendMessage","chatId","text","messageData","Timestamp","addDoc","chatDoc","chatUpdate","createNewChat","existingChatQuery","existingChat","getDocs","setActiveChatById","c","markChatAsRead","unreadMessagesSnapshot","batch","total","chatUnreadCount","jsx","FavoritesContext","useFavorites","FavoritesProvider","favorites","setFavorites","fetchFavorites","favoritesRef","favoritesQuery","querySnapshot","fetchedFavorites","data","addFavorite","jobId","jobData","favoriteId","favoriteRef","favoriteData","newFavorite","prev","fav","removeFavorite","deleteDoc","isFavorite","refreshFavorites","ProtectedRoute","requiredRole","jsxs","Navigate","Outlet","PublicRoute","Login","lazy","Register","ResetPassword","Landing","About","Candidates","CandidateProfile","Jobs","JobDetail","JobApplicationForm","Messages","Conversation","ScheduleMeeting","Calendar","ApplicationDetail","DashboardRoutes","Applications","SearchJobs","Settings","Loading","SimpleDashboard","AuthDebugger","Redirect","AppContent","handleGlobalError","event","Router","Suspense","Routes","Route","App","rootElement","ErrorBoundary","React","props","errorInfo","root","ReactDOM"],"ignoreList":[],"sources":["../../src/types/user.ts","../../src/firebase/config.ts","../../src/contexts/AuthContext.tsx","../../src/contexts/MessageContext.tsx","../../src/contexts/FavoritesContext.tsx","../../src/components/common/ProtectedRoute.tsx","../../src/components/common/PublicRoute.tsx","../../src/App.tsx","../../src/main.jsx"],"sourcesContent":["import { User as FirebaseUser } from 'firebase/auth';\nimport { Timestamp } from 'firebase/firestore';\nimport { DetailedCV } from './cv';\n\n// Mogelijke gebruikersrollen (in zowel Nederlands als Engels)\nexport type UserRole = 'werkzoekende' | 'jobseeker' | 'recruiter' | 'admin';\n\n// Gemeenschappelijke adresvelden die worden gebruikt in verschillende plaatsen\nexport interface AddressFields {\n  street?: string;\n  houseNumber?: string;\n  postalCode?: string;\n  city?: string;\n  country?: string;\n}\n\n// Basis gebruikerstype\nexport interface BaseUser {\n  id: string;\n  email: string;\n  role: UserRole;\n  detailedCV?: DetailedCV;\n  // Alle overige velden die we niet specifiek kennen accepteren we ook\n  [key: string]: any;\n}\n\n// Uitgebreid gebruikerstype met profiel\nexport interface UserProfile extends BaseUser {\n  bio?: string;\n  phone?: string;\n}\n\n/**\n * Bepaalt of een gebruiker een werkzoekende is\n */\nexport function isJobSeeker(user: BaseUser | null): boolean {\n  if (!user) return false;\n  return user.role === 'werkzoekende' || user.role === 'jobseeker';\n}\n\n/**\n * Bepaalt of een gebruiker een recruiter is\n */\nexport function isRecruiter(user: BaseUser | null): boolean {\n  if (!user) return false;\n  return user.role === 'recruiter';\n}\n\n// Type voor een geauthenticeerde gebruiker van Firebase\nexport interface AuthUser extends FirebaseUser {\n  userProfile?: UserProfile;\n}\n\n// Soorten login methodes\nexport type LoginMethod = 'email' | 'google' | 'facebook';\n\n// Status van authenticatie\nexport type AuthStatus = 'initial' | 'authenticated' | 'unauthenticated';\n\n// Context object voor authenticatie\nexport interface AuthContextType {\n  user: AuthUser | null;\n  userData: BaseUser | null;\n  status: AuthStatus;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  login: (email: string, password: string) => Promise<any>;\n  loginWithGoogle: () => Promise<any>;\n  register: (email: string, password: string, userData: BaseUser) => Promise<any>;\n  logout: () => Promise<void>;\n  updateProfile: (data: Partial<BaseUser>) => Promise<any>;\n  resetPassword: (email: string) => Promise<void>;\n}\n\n// Deze interfaces vertegenwoordigen de ideale structuur, maar alle velden zijn optioneel\n// om compatibel te blijven met bestaande data die mogelijk niet alle velden heeft\nexport interface JobSeekerProfile extends UserProfile {\n  skills?: string[];\n  cv?: string;\n  availability?: string;\n  experience?: any[];\n  education?: any[];\n  linkedin?: string;\n  portfolio?: string;\n  coverLetter?: string;\n  isAvailableForWork?: boolean;\n  pitchVideo?: string; // URL naar de persoonlijke video pitch\n}\n\nexport interface RecruiterProfile extends UserProfile {\n  company?: string;\n  companyLogo?: string;\n  companyWebsite?: string;\n  companyDescription?: string;\n  position?: string;\n  kvkNumber?: string;\n  industry?: string;\n}\n\n// Nog steeds de ideale interfaces, maar met alle velden optioneel\nexport interface JobSeeker extends BaseUser {\n  role: 'werkzoekende' | 'jobseeker';\n  profile?: JobSeekerProfile; // Optioneel omdat sommige profielen dit misschien niet hebben\n}\n\nexport interface Recruiter extends BaseUser {\n  role: 'recruiter';\n  profile?: RecruiterProfile; // Optioneel omdat sommige profielen dit misschien niet hebben\n}\n\n/**\n * Bepaalt de rol van een gebruiker op basis van hun profielgegevens\n */\nexport function getUserRole(user: BaseUser | null): UserRole | null {\n  if (!user) return null;\n  if (isJobSeeker(user)) return 'jobseeker';\n  if (isRecruiter(user)) return 'recruiter';\n  return null;\n}\n\nexport type User = JobSeeker | Recruiter;\n\nexport interface WorkExperience {\n  id: string;\n  functie: string;\n  bedrijf: string;\n  startDatum: Timestamp | null;\n  eindDatum: Timestamp | null;\n  beschrijving: string;\n  isHuidigeFunctie: boolean;\n}\n\nexport interface Education {\n  id: string;\n  opleiding: string;\n  instituut: string;\n  startDatum: Timestamp | null;\n  eindDatum: Timestamp | null;\n  beschrijving: string;\n  isHuidigeOpleiding: boolean;\n}\n\nexport interface Internship {\n  id: string;\n  functie: string;\n  bedrijf: string;\n  startDatum: Timestamp | null;\n  eindDatum: Timestamp | null;\n  beschrijving: string;\n  isHuidigeStage: boolean;\n}\n\nexport interface Certificate {\n  id: string;\n  naam: string;\n  uitgever: string;\n  datum: Timestamp | null;\n  beschrijving: string;\n}\n\nexport interface Language {\n  id: string;\n  taal: string;\n  niveau: string;\n  beschrijving?: string;\n}\n\nexport interface Hobby {\n  id: string;\n  naam: string;\n  beschrijving?: string;\n}\n\nexport interface IDetailedCV {\n  overMij: string;\n  werkervaring: WorkExperience[];\n  opleiding: Education[];\n  stages: Internship[];\n  certificaten: Certificate[];\n  talen: Language[];\n  hobbys: Hobby[];\n} ","// Firebase configuratie, geoptimaliseerd voor code-splitting\n// Elke module wordt dynamisch geïmporteerd alleen wanneer nodig\n\n// Firebase configuratie uit omgevingsvariabelen\n// Bij gebruik, maak een .env bestand met deze variabelen\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\n  measurementId: process.env.REACT_APP_FIREBASE_MEASUREMENT_ID\n};\n\n// Debug: Log de omgevingsvariabelen\nconsole.log('Firebase omgevingsvariabelen status:');\nconsole.log('API Key aanwezig:', !!process.env.REACT_APP_FIREBASE_API_KEY);\nconsole.log('Auth Domain aanwezig:', !!process.env.REACT_APP_FIREBASE_AUTH_DOMAIN);\nconsole.log('Project ID aanwezig:', !!process.env.REACT_APP_FIREBASE_PROJECT_ID);\n\n// Als er geen omgevingsvariabelen zijn gevonden, gebruik deze fallback\n// en toon een waarschuwing\nif (!firebaseConfig.apiKey) {\n  console.warn(\n    'Firebase configuratie niet gevonden in environment variables. ' +\n    'Gebruik van fallback configuratie. ' +\n    'Voor productieomgevingen, zorg ervoor dat je .env.local correct is ingesteld.'\n  );\n  \n  // Directe configuratie als fallback\n  firebaseConfig.apiKey = \"AIzaSyAiTY14VexbFUQTf3yKhDPhrCtKjRzhMwQ\";\n  firebaseConfig.authDomain = \"pitchpro-29e90.firebaseapp.com\";\n  firebaseConfig.projectId = \"pitchpro-29e90\";\n  firebaseConfig.storageBucket = \"pitchpro-29e90.firebasestorage.app\";\n  firebaseConfig.messagingSenderId = \"121788535713\";\n  firebaseConfig.appId = \"1:121788535713:web:9c5ddf4ff9af0a0e2ff1e0\";\n  firebaseConfig.measurementId = \"G-QGBR93ZYCM\";\n}\n\n// Debug: Log de uiteindelijke Firebase configuratie (zonder API key voor veiligheid)\nconsole.log('Firebase configuratie:', {\n  ...firebaseConfig,\n  apiKey: firebaseConfig.apiKey ? 'AANWEZIG' : 'ONTBREEKT',\n});\n\n// Deze caches zorgen ervoor dat we niet meerdere instances initialiseren\nlet appInstance: any = null;\nlet authInstance: any = null;\nlet dbInstance: any = null;\nlet storageInstance: any = null;\nlet analyticsInstance: any = null;\n\n// Initialiseer Firebase app (alleen indien nodig)\nexport const getFirebaseApp = async () => {\n  if (!appInstance) {\n    const { initializeApp } = await import('firebase/app');\n    appInstance = initializeApp(firebaseConfig);\n  }\n  return appInstance;\n};\n\n// Verkrijg auth service (dynamisch geïmporteerd)\nexport const getFirebaseAuth = async () => {\n  if (!authInstance) {\n    const app = await getFirebaseApp();\n    const { getAuth } = await import('firebase/auth');\n    authInstance = getAuth(app);\n  }\n  return authInstance;\n};\n\n// Verkrijg Firestore service (dynamisch geïmporteerd)\nexport const getFirestore = async () => {\n  if (!dbInstance) {\n    const app = await getFirebaseApp();\n    const { getFirestore: fsGetFirestore } = await import('firebase/firestore');\n    dbInstance = fsGetFirestore(app);\n  }\n  return dbInstance;\n};\n\n// Verkrijg Storage service (dynamisch geïmporteerd)\nexport const getStorage = async () => {\n  if (!storageInstance) {\n    const app = await getFirebaseApp();\n    const { getStorage: fsGetStorage } = await import('firebase/storage');\n    storageInstance = fsGetStorage(app);\n  }\n  return storageInstance;\n};\n\n// Verkrijg Analytics service (dynamisch geïmporteerd, alleen in browser)\nexport const getAnalytics = async () => {\n  if (!analyticsInstance && typeof window !== 'undefined') {\n    const app = await getFirebaseApp();\n    const { getAnalytics: fsGetAnalytics } = await import('firebase/analytics');\n    analyticsInstance = fsGetAnalytics(app);\n  }\n  return analyticsInstance;\n};\n\n// Voor backward compatibiliteit, exporteer ook de oude variabelen\n// Deze worden later lazy geïnitialiseerd\nexport let auth: any = null;\nexport let db: any = null;\nexport let storage: any = null;\nexport let analytics: any = null;\n\n// Initialiseer services als ze direct worden aangeroepen\n// Dit is een fallback voor code die de oude exports direct gebruikt\nconst initializeServices = async () => {\n  auth = await getFirebaseAuth();\n  db = await getFirestore();\n  storage = await getStorage();\n  if (typeof window !== 'undefined') {\n    analytics = await getAnalytics();\n  }\n};\n\n// Start de initialisatie als achtergrondtaak\ninitializeServices().catch(error => \n  console.error('Firebase services konden niet worden geïnitialiseerd:', error)\n);\n\nexport default getFirebaseApp; ","import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { \n  User as FirebaseUser,\n} from 'firebase/auth';\nimport { \n  User, \n  UserRole, \n  BaseUser, \n  JobSeeker, \n  Recruiter, \n  getUserRole,\n  isJobSeeker,\n  isRecruiter,\n  UserProfile\n} from '../types/user';\nimport { \n  getFirebaseAuth, \n  getFirestore as getFirestoreDB,\n  auth as authInstance,\n  db as dbInstance\n} from '../firebase/config';\n\nexport interface AuthContextType {\n  currentUser: FirebaseUser | null;\n  userProfile: BaseUser | null;\n  loading: boolean;\n  authError: Error | null;\n  register: (email: string, password: string, displayName: string, role: UserRole) => Promise<void>;\n  login: (email: string, password: string) => Promise<void>;\n  logout: () => Promise<void>;\n  resetPassword: (email: string) => Promise<void>;\n  createOrUpdateProfile: (displayName: string, role: UserRole) => Promise<BaseUser>;\n  refreshUserProfile: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth moet binnen een AuthProvider gebruikt worden');\n  }\n  return context;\n};\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState<FirebaseUser | null>(null);\n  const [userProfile, setUserProfile] = useState<BaseUser | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [authError, setAuthError] = useState<Error | null>(null);\n\n  console.log(\"AuthProvider initialiseren...\");\n\n  // Helper functie om datum te normaliseren\n  const normalizeDate = (date: any): Date => {\n    if (date && typeof date === 'object' && date.toDate && typeof date.toDate === 'function') {\n      return date.toDate(); // Converteer Firestore Timestamp naar JS Date\n    }\n    return date;\n  };\n\n  // Helper functie om gebruikersdata te normaliseren naar ons type systeem\n  const normalizeUserData = (userData: any, uid: string): BaseUser => {\n    console.log('Normalizing user data for:', uid, userData);\n    \n    // Valideer en normaliseer de rol\n    let role = userData.role || userData.userType || 'werkzoekende';\n    \n    // Zet Engelse waardes om naar Nederlandse waardes\n    if (role === 'jobseeker') {\n      role = 'werkzoekende';\n      console.warn('Converted English role \"jobseeker\" to Dutch \"werkzoekende\"');\n    }\n    \n    // Zorg ervoor dat userType ook consistent is\n    let userType = userData.userType || role;\n    if (userType === 'jobseeker') {\n      userType = 'werkzoekende';\n    }\n    \n    // Basis gebruikersgegevens\n    const normalizedUser: BaseUser = {\n      id: uid,\n      email: userData.email || '',\n      displayName: userData.displayName || userData.name || '',\n      photoURL: userData.photoURL || userData.avatar || '',\n      bio: userData.bio || '',\n      phone: userData.phone || '',\n      role: role,\n      userType: userType,\n      createdAt: userData.createdAt || new Date(),\n      updatedAt: userData.updatedAt || new Date(),\n      // Gebruik het bestaande profile object of maak een nieuw object\n      profile: userData.profile ? { ...userData.profile } : {}\n    };\n\n    // Normaliseer de profielgegevens op basis van rol\n    if (isJobSeeker(normalizedUser)) {\n      // Zorg ervoor dat de profile object bestaat\n      if (!normalizedUser.profile) normalizedUser.profile = {};\n      \n      // Voeg werkzoekende-specifieke velden toe aan profile\n      normalizedUser.profile.skills = userData.skills || userData.profile?.skills || [];\n      normalizedUser.profile.education = userData.education || userData.profile?.education || [];\n      normalizedUser.profile.experience = userData.experience || userData.profile?.experience || [];\n      normalizedUser.profile.cv = userData.cv || userData.profile?.cv || '';\n      normalizedUser.profile.portfolio = userData.portfolio || userData.profile?.portfolio || '';\n      normalizedUser.profile.linkedin = userData.linkedin || userData.profile?.linkedin || '';\n      normalizedUser.profile.address = userData.address || userData.profile?.address || '';\n      normalizedUser.profile.city = userData.city || userData.profile?.city || '';\n    } else if (isRecruiter(normalizedUser)) {\n      // Zorg ervoor dat de profile object bestaat\n      if (!normalizedUser.profile) normalizedUser.profile = {};\n      \n      // Voeg recruiter-specifieke velden toe aan profile\n      normalizedUser.profile.companyName = userData.companyName || userData.profile?.companyName || '';\n      normalizedUser.profile.companyDescription = userData.companyDescription || userData.profile?.companyDescription || '';\n      normalizedUser.profile.kvkNumber = userData.kvkNumber || userData.profile?.kvkNumber || '';\n      normalizedUser.profile.website = userData.website || userData.profile?.website || '';\n      normalizedUser.profile.companyLogo = userData.companyLogo || userData.profile?.companyLogo || '';\n      normalizedUser.profile.industry = userData.industry || userData.profile?.industry || '';\n      normalizedUser.profile.companySize = userData.companySize || userData.profile?.companySize || '';\n      normalizedUser.profile.companyLocation = userData.companyLocation || userData.profile?.companyLocation || '';\n    }\n    \n    // Debug: log de genormaliseerde gebruiker\n    console.debug('Normalized user data:', {\n      id: normalizedUser.id,\n      email: normalizedUser.email,\n      role: normalizedUser.role,\n      userType: normalizedUser.userType,\n      hasProfile: !!normalizedUser.profile && Object.keys(normalizedUser.profile).length > 0\n    });\n    \n    return normalizedUser;\n  };\n\n  // Verbeterde functie om gebruikersprofiel aan te maken\n  const createUserProfile = async (\n    userId: string, \n    email: string, \n    displayName: string, \n    role: UserRole\n  ): Promise<BaseUser> => {\n    console.log(\"Nieuw gebruikersprofiel aanmaken voor\", userId);\n    \n    // Lazy-load Firestore\n    const db = dbInstance || await getFirestoreDB();\n    const { doc, setDoc } = await import('firebase/firestore');\n    \n    const userDocRef = doc(db, 'users', userId);\n    \n    const baseUserData: BaseUser = {\n      id: userId,\n      email: email || '',\n      displayName,\n      fullName: displayName, // Zorg dat beide naamvelden ingevuld zijn\n      role,\n      userType: role, // Zet beide rolvelden voor maximale compatibiliteit\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    \n    // Voeg rolspecifieke velden toe\n    let userData: BaseUser;\n    \n    if (role === 'werkzoekende') {\n      userData = {\n        ...baseUserData,\n        profile: {\n          skills: [],\n          availability: '',\n          cv: '',\n          linkedin: '',\n          portfolio: '',\n          experience: '',\n          education: []\n        }\n      };\n    } else {\n      userData = {\n        ...baseUserData,\n        profile: {\n          company: '',\n          position: '',\n          companyLogo: '',\n          companyWebsite: '',\n          companyDescription: '',\n          kvkNumber: ''\n        }\n      };\n    }\n        \n    // Sla het gebruikersprofiel op in Firestore\n    await setDoc(userDocRef, userData);\n    \n    console.log(\"Gebruikersprofiel aangemaakt:\", role);\n    \n    return userData;\n  };\n\n  // Register function updated to use the common profile creation\n  const register = async (email: string, password: string, displayName: string, role: UserRole) => {\n    try {\n      // Lazy-load Firebase auth\n      const auth = authInstance || await getFirebaseAuth();\n      const { createUserWithEmailAndPassword, updateProfile } = await import('firebase/auth');\n      \n      // Maak een gebruiker aan met Firebase Auth\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n      const user = userCredential.user;\n      \n      // Update de gebruiker met displayName\n      await updateProfile(user, { displayName });\n      \n      // Maak het gebruikersprofiel aan\n      const profileData = await createUserProfile(user.uid, user.email || '', displayName, role);\n      setUserProfile(profileData);\n    } catch (error) {\n      console.error('Fout bij registratie:', error);\n      throw error;\n    }\n  };\n\n  // Login with email and password\n  const login = async (email: string, password: string) => {\n    try {\n      console.log('Inlogpoging voor:', email);\n      \n      // Lazy-load Firebase auth\n      const auth = authInstance || await getFirebaseAuth();\n      const { signInWithEmailAndPassword } = await import('firebase/auth');\n      \n      await signInWithEmailAndPassword(auth, email, password);\n      console.log('Inloggen succesvol');\n    } catch (error: any) {\n      console.error('Fout bij inloggen:', error);\n      console.error('Fout code:', error.code);\n      console.error('Fout bericht:', error.message);\n      throw error;\n    }\n  };\n\n  // Logout\n  const logout = async () => {\n    try {\n      // Lazy-load Firebase auth\n      const auth = authInstance || await getFirebaseAuth();\n      const { signOut } = await import('firebase/auth');\n      \n      await signOut(auth);\n    } catch (error) {\n      console.error('Fout bij uitloggen:', error);\n      throw error;\n    }\n  };\n\n  // Reset password\n  const resetPassword = async (email: string) => {\n    try {\n      // Lazy-load Firebase auth\n      const auth = authInstance || await getFirebaseAuth();\n      const { sendPasswordResetEmail } = await import('firebase/auth');\n      \n      await sendPasswordResetEmail(auth, email);\n    } catch (error) {\n      console.error('Fout bij wachtwoord reset:', error);\n      throw error;\n    }\n  };\n\n  // Verbeterde functie voor het laden van het gebruikersprofiel met betere foutafhandeling\n  const loadUserProfile = async (userId: string) => {\n    try {\n      console.log(\"Bezig met laden van gebruikersprofiel voor\", userId);\n      \n      // Lazy-load Firestore\n      const db = dbInstance || await getFirestoreDB();\n      const { doc, getDoc, updateDoc } = await import('firebase/firestore');\n      \n      const userDocRef = doc(db, 'users', userId);\n      const userDoc = await getDoc(userDocRef);\n      \n      if (userDoc.exists()) {\n        // Haal ruwe data op\n        const rawUserData = userDoc.data();\n        console.log(\"Ruwe gebruikersdata uit Firestore:\", rawUserData);\n        \n        // Controleer op minimaal benodigde velden\n        if (!rawUserData.email) {\n          console.warn(\"Gebruikersprofiel heeft geen email - proberen te repareren\");\n          // Voeg email toe uit Firebase Auth\n          if (currentUser?.email) {\n            await updateDoc(userDocRef, { email: currentUser.email });\n            rawUserData.email = currentUser.email;\n          }\n        }\n        \n        // Voeg ID toe als het ontbreekt\n        const userData: Record<string, any> = {\n          ...rawUserData,\n          id: userId // Zorg ervoor dat id altijd aanwezig is\n        };\n        \n        // Controleer of de rol is ingesteld\n        if (!userData.role && !userData.userType) {\n          console.warn(\"Gebruikersprofiel heeft geen rol - proberen te repareren\");\n          userData.role = 'werkzoekende'; // Standaard rol als noodoplossing\n          await updateDoc(userDocRef, { role: 'werkzoekende', userType: 'werkzoekende' });\n        }\n        \n        // Zorg ervoor dat het profiel object bestaat\n        if (!userData.profile || Object.keys(userData.profile || {}).length === 0) {\n          console.warn(\"Gebruikersprofiel heeft geen profiel object - proberen te repareren\");\n          \n          // Maak een leeg profiel aan op basis van de rol\n          if (userData.role === 'werkzoekende' || userData.userType === 'werkzoekende') {\n            userData.profile = {\n              skills: [],\n              availability: '',\n              cv: '',\n              linkedin: '',\n              portfolio: '',\n              experience: '',\n              education: []\n            };\n            await updateDoc(userDocRef, { profile: userData.profile });\n          } else if (userData.role === 'recruiter' || userData.userType === 'recruiter') {\n            userData.profile = {\n              company: '',\n              position: '',\n              companyLogo: '',\n              companyWebsite: '',\n              companyDescription: '',\n              kvkNumber: ''\n            };\n            await updateDoc(userDocRef, { profile: userData.profile });\n          }\n        }\n        \n        // Normaliseer de gebruikersdata\n        const normalizedUserData = normalizeUserData(userData, userId);\n        console.log(\"Genormaliseerde gebruikersdata:\", normalizedUserData);\n        \n        // Controleer of we een geldig gebruikersprofiel hebben\n        const userRole = getUserRole(normalizedUserData);\n        if (!userRole) {\n          console.warn(\"Gebruikersprofiel heeft geen geldige rol - zetten op null\");\n          setUserProfile(null);\n        } else {\n          // Alles is goed, sla het profiel op in de state\n          console.log(\"Gebruikersprofiel geladen met rol:\", userRole);\n          setUserProfile(normalizedUserData);\n        }\n      } else {\n        console.error('Geen gebruikersprofiel gevonden in Firestore');\n        setUserProfile(null);\n      }\n    } catch (error) {\n      console.error('Fout bij laden gebruikersprofiel:', error);\n      setUserProfile(null);\n      throw error;\n    }\n  };\n\n  // Functie om het gebruikersprofiel manueel te verversen\n  const refreshUserProfile = async () => {\n    if (!currentUser) {\n      throw new Error('Kan profiel niet verversen: gebruiker niet ingelogd');\n    }\n    \n    try {\n      await loadUserProfile(currentUser.uid);\n      return;\n    } catch (error) {\n      console.error('Fout bij verversen gebruikersprofiel:', error);\n      throw error;\n    }\n  };\n\n  // Create or update user profile function\n  const createOrUpdateProfile = async (displayName: string, role: UserRole): Promise<BaseUser> => {\n    if (!currentUser) {\n      throw new Error('Je moet ingelogd zijn om een profiel aan te maken');\n    }\n    \n    try {\n      const userData = await createUserProfile(\n        currentUser.uid, \n        currentUser.email || '', \n        displayName || currentUser.displayName || 'Gebruiker', \n        role\n      );\n      \n      // Update state synchronously\n      setUserProfile(userData);\n      \n      return userData;\n    } catch (error) {\n      console.error('Fout bij aanmaken/updaten profiel:', error);\n      throw error;\n    }\n  };\n\n  // Auth state veranderingen monitoren met verbeterde timeout handling\n  useEffect(() => {\n    console.log(\"Auth state verandering monitoren opstarten...\");\n    \n    // Verhoog de timeout naar 15 seconden voor een betere gebruikerservaring\n    const safetyTimer = setTimeout(() => {\n      console.log(\"VEILIGHEIDSTIMER: loading geforceerd op false na timeout\");\n      setLoading(false);\n      setAuthError(new Error(\"Het profiel kon niet tijdig worden geladen. Probeer het opnieuw.\"));\n    }, 15000);\n    \n    const initAuth = async () => {\n      try {\n        // Lazy-load Firebase auth\n        const auth = authInstance || await getFirebaseAuth();\n        const { onAuthStateChanged } = await import('firebase/auth');\n        \n        const unsubscribe = onAuthStateChanged(auth, async (user) => {\n          try {\n            console.log(\"Auth state verandering gedetecteerd:\", user ? \"Gebruiker aanwezig\" : \"Geen gebruiker\");\n            setCurrentUser(user);\n            \n            if (user) {\n              try {\n                await loadUserProfile(user.uid);\n              } catch (error) {\n                console.error(\"Fout bij laden gebruikersprofiel:\", error);\n                // Zet loading op false, zelfs als er een fout is\n                setUserProfile(null);\n                if (error instanceof Error) {\n                  setAuthError(error);\n                } else {\n                  setAuthError(new Error(\"Onbekende fout bij laden gebruikersprofiel\"));\n                }\n              }\n            } else {\n              setUserProfile(null);\n            }\n            \n            console.log(\"Loading status wordt op false gezet\");\n            setLoading(false);\n            // Annuleer de timer omdat we nu klaar zijn met laden\n            clearTimeout(safetyTimer);\n          } catch (error) {\n            console.error(\"Onverwachte fout in auth state verandering handler:\", error);\n            setLoading(false);\n            clearTimeout(safetyTimer);\n            if (error instanceof Error) {\n              setAuthError(error);\n            } else {\n              setAuthError(new Error(\"Onverwachte fout in auth state verandering handler\"));\n            }\n          }\n        });\n    \n        return () => {\n          unsubscribe();\n          clearTimeout(safetyTimer);\n        };\n      } catch (error) {\n        console.error(\"Kritieke fout bij initialiseren Firebase Auth:\", error);\n        setLoading(false);\n        clearTimeout(safetyTimer);\n        if (error instanceof Error) {\n          setAuthError(error);\n        } else {\n          setAuthError(new Error(\"Kritieke fout bij initialiseren Firebase Auth\"));\n        }\n        \n        // Return lege cleanup functie\n        return () => {};\n      }\n    };\n    \n    // Start the auth initialization\n    const cleanup = initAuth();\n    \n    // Return the cleanup function\n    return () => {\n      if (cleanup && typeof cleanup.then === 'function') {\n        cleanup.then(cleanupFn => {\n          if (cleanupFn) cleanupFn();\n        });\n      }\n      clearTimeout(safetyTimer);\n    };\n  }, []);\n\n  console.log(\"AuthProvider rendering met loading status:\", loading, \"authError:\", authError ? \"JA\" : \"NEE\");\n\n  const value = {\n    currentUser,\n    userProfile,\n    loading,\n    authError,\n    register,\n    login,\n    logout,\n    resetPassword,\n    createOrUpdateProfile,\n    refreshUserProfile\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {!loading && children}\n    </AuthContext.Provider>\n  );\n}; ","import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { collection, query, where, orderBy, getDocs, addDoc, updateDoc, doc, onSnapshot, Timestamp, getDoc, DocumentData } from 'firebase/firestore';\nimport { db } from '../firebase/config';\nimport { useAuth } from './AuthContext';\nimport { Chat, Message, ChatWithUserDetails } from '../types/message';\n\ninterface MessageContextType {\n  chats: ChatWithUserDetails[];\n  activeChat: ChatWithUserDetails | null;\n  messages: Message[];\n  loadingChats: boolean;\n  loadingMessages: boolean;\n  error: string | null;\n  sendMessage: (chatId: string, text: string) => Promise<void>;\n  createNewChat: (userId: string) => Promise<string>;\n  setActiveChatById: (chatId: string) => Promise<void>;\n  markChatAsRead: (chatId: string) => Promise<void>;\n  getUnreadCount: () => number;\n}\n\nconst MessageContext = createContext<MessageContextType | undefined>(undefined);\n\nexport const useMessages = () => {\n  const context = useContext(MessageContext);\n  if (context === undefined) {\n    throw new Error('useMessages moet binnen een MessageProvider gebruikt worden');\n  }\n  return context;\n};\n\ninterface MessageProviderProps {\n  children: ReactNode;\n}\n\nexport const MessageProvider: React.FC<MessageProviderProps> = ({ children }) => {\n  const { currentUser } = useAuth();\n  const [chats, setChats] = useState<ChatWithUserDetails[]>([]);\n  const [activeChat, setActiveChat] = useState<ChatWithUserDetails | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [loadingChats, setLoadingChats] = useState<boolean>(true);\n  const [loadingMessages, setLoadingMessages] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Luisteren naar chats bij het inloggen van een gebruiker\n  useEffect(() => {\n    if (!currentUser) {\n      setChats([]);\n      setActiveChat(null);\n      setMessages([]);\n      setLoadingChats(false);\n      return;\n    }\n\n    setLoadingChats(true);\n    setError(null);\n\n    const chatsRef = collection(db, 'chats');\n    const q = query(\n      chatsRef,\n      where('participants', 'array-contains', currentUser.uid),\n      orderBy('lastMessageTimestamp', 'desc')\n    );\n\n    // Real-time subscription op chats\n    const unsubscribe = onSnapshot(\n      q,\n      async (snapshot) => {\n        try {\n          const chatPromises = snapshot.docs.map(async (docSnapshot) => {\n            const chatData = docSnapshot.data() as Chat;\n            \n            // Haal gegevens op van de andere persoon in de chat\n            const otherUserId = chatData.participants.find(id => id !== currentUser.uid);\n            \n            if (!otherUserId) {\n              console.error('Geen andere gebruiker gevonden in chat', chatData.id);\n              return null;\n            }\n            \n            // Haal gebruikersgegevens op\n            const userDocRef = doc(db, 'users', otherUserId);\n            const userDoc = await getDoc(userDocRef);\n            \n            if (!userDoc.exists()) {\n              console.error('Gebruiker niet gevonden', otherUserId);\n              return null;\n            }\n            \n            const userData = userDoc.data() as DocumentData;\n            \n            // Bepaal de unreadCount voor de huidige gebruiker\n            let unreadCount = 0;\n            if (typeof chatData.unreadCount === 'number') {\n              // Als unreadCount een getal is, gebruik dat getal\n              unreadCount = chatData.unreadCount;\n            } else if (typeof chatData.unreadCount === 'object' && chatData.unreadCount !== null) {\n              // Als unreadCount een object is (Record<string, number>), gebruik de waarde voor de huidige gebruiker\n              unreadCount = chatData.unreadCount[currentUser.uid] || 0;\n            }\n            \n            return {\n              ...chatData,\n              id: docSnapshot.id,\n              otherUser: {\n                id: otherUserId,\n                displayName: (userData.displayName as string) || (userData.name as string) || 'Onbekende gebruiker',\n                photoURL: (userData.photoURL as string) || \n                         (userData.profileImage as string) || \n                         (userData.profilePhoto as string) || \n                         (userData.profile?.profilePhoto as string) || \n                         (userData.profile?.profileImage as string) || \n                         '',\n                role: (userData.role as string) || (userData.userType as string) || '',\n              },\n              unreadCount: unreadCount\n            } as ChatWithUserDetails;\n          });\n          \n          const resolvedChats = await Promise.all(chatPromises);\n          const validChats = resolvedChats.filter(chat => chat !== null) as ChatWithUserDetails[];\n          \n          setChats(validChats);\n          setLoadingChats(false);\n        } catch (err) {\n          console.error('Fout bij het ophalen van chats:', err);\n          setError('Kon chats niet laden. Probeer het later opnieuw.');\n          setLoadingChats(false);\n        }\n      },\n      (err) => {\n        console.error('Fout bij chat subscription:', err);\n        setError('Kon chats niet laden. Probeer het later opnieuw.');\n        setLoadingChats(false);\n      }\n    );\n\n    return () => unsubscribe();\n  }, [currentUser]);\n\n  // Luisteren naar berichten wanneer een actieve chat is geselecteerd\n  useEffect(() => {\n    if (!activeChat) {\n      setMessages([]);\n      return;\n    }\n\n    setLoadingMessages(true);\n    \n    const messagesRef = collection(db, 'chats', activeChat.id, 'messages');\n    const q = query(messagesRef, orderBy('timestamp', 'asc'));\n    \n    const unsubscribe = onSnapshot(\n      q,\n      (snapshot) => {\n        const messagesData = snapshot.docs.map(doc => ({\n          ...doc.data(),\n          id: doc.id\n        } as Message));\n        \n        setMessages(messagesData);\n        setLoadingMessages(false);\n      },\n      (err) => {\n        console.error('Fout bij messages subscription:', err);\n        setError('Kon berichten niet laden. Probeer het later opnieuw.');\n        setLoadingMessages(false);\n      }\n    );\n    \n    return () => unsubscribe();\n  }, [activeChat]);\n\n  // Functie om berichten te sturen\n  const sendMessage = async (chatId: string, text: string) => {\n    if (!currentUser) {\n      throw new Error('Je moet ingelogd zijn om berichten te sturen');\n    }\n    \n    try {\n      const messageData = {\n        senderId: currentUser.uid,\n        text,\n        timestamp: Timestamp.now(),\n        read: false\n      };\n      \n      // Voeg het bericht toe aan de subcollectie 'messages'\n      await addDoc(collection(db, 'chats', chatId, 'messages'), messageData);\n      \n      // Haal de huidige chat op om de andere deelnemer te vinden\n      const chatDoc = await getDoc(doc(db, 'chats', chatId));\n      if (!chatDoc.exists()) {\n        throw new Error('Chat niet gevonden');\n      }\n      \n      const chatData = chatDoc.data() as Chat;\n      const otherUserId = chatData.participants.find(id => id !== currentUser.uid);\n      \n      if (!otherUserId) {\n        throw new Error('Kon andere gebruiker in de chat niet vinden');\n      }\n      \n      // Update de chat met het laatste bericht\n      const chatUpdate: Record<string, any> = {\n        lastMessage: text,\n        lastMessageTimestamp: Timestamp.now(),\n        updatedAt: Timestamp.now(),\n      };\n      \n      // Update unreadCount voor de andere gebruiker\n      if (typeof chatData.unreadCount === 'number') {\n        // Als unreadCount een getal is (oude structuur), zet het om naar een object\n        chatUpdate.unreadCount = {\n          [currentUser.uid]: 0,\n          [otherUserId]: (chatData.unreadCount || 0) + 1\n        };\n      } else {\n        // Als unreadCount al een object is\n        chatUpdate[`unreadCount.${otherUserId}`] = ((chatData.unreadCount as Record<string, number>)[otherUserId] || 0) + 1;\n      }\n      \n      await updateDoc(doc(db, 'chats', chatId), chatUpdate);\n    } catch (err) {\n      console.error('Fout bij het verzenden van bericht:', err);\n      throw new Error('Kon bericht niet verzenden. Probeer het later opnieuw.');\n    }\n  };\n\n  // Functie om een nieuwe chat aan te maken\n  const createNewChat = async (otherUserId: string) => {\n    if (!currentUser) {\n      throw new Error('Je moet ingelogd zijn om een chat te starten');\n    }\n    \n    try {\n      // Controleer of er al een chat bestaat tussen deze twee gebruikers\n      const existingChatQuery = query(\n        collection(db, 'chats'),\n        where('participants', 'array-contains', currentUser.uid)\n      );\n      \n      const existingChatsSnapshot = await getDocs(existingChatQuery);\n      const existingChat = existingChatsSnapshot.docs.find(doc => {\n        const data = doc.data();\n        return data.participants.includes(otherUserId);\n      });\n      \n      if (existingChat) {\n        // Als de chat al bestaat, gebruik die\n        return existingChat.id;\n      }\n      \n      // Maak nieuwe chat aan met nieuwe structuur\n      const newChatRef = await addDoc(collection(db, 'chats'), {\n        participants: [currentUser.uid, otherUserId],\n        lastMessage: '', // Lege string voor nieuw aangemaakte chat\n        lastMessageTimestamp: Timestamp.now(), // Huidige tijd als timestamp\n        createdAt: Timestamp.now(),\n        updatedAt: Timestamp.now(),\n        unreadCount: {\n          [currentUser.uid]: 0,\n          [otherUserId]: 0\n        }\n      });\n      \n      return newChatRef.id;\n    } catch (err) {\n      console.error('Fout bij het aanmaken van een nieuwe chat:', err);\n      throw new Error('Kon geen nieuwe chat starten. Probeer het later opnieuw.');\n    }\n  };\n\n  // Functie om een actieve chat in te stellen\n  const setActiveChatById = async (chatId: string) => {\n    try {\n      const chat = chats.find(c => c.id === chatId);\n      \n      if (chat) {\n        setActiveChat(chat);\n        // Markeer berichten als gelezen wanneer actieve chat wordt ingesteld\n        await markChatAsRead(chatId);\n      } else {\n        // Chat bestaat niet in de state, probeer op te halen\n        const chatDoc = await getDoc(doc(db, 'chats', chatId));\n        \n        if (!chatDoc.exists()) {\n          throw new Error('Chat bestaat niet');\n        }\n        \n        // Implementatie zou soortgelijk zijn aan de fetchChats functie\n        // maar dan voor een enkele chat\n        // ...\n        \n        setError('Chat kon niet worden gevonden.');\n      }\n    } catch (err) {\n      console.error('Fout bij het instellen van actieve chat:', err);\n      setError('Kon de chat niet openen. Probeer het later opnieuw.');\n    }\n  };\n\n  // Functie om chat als gelezen te markeren\n  const markChatAsRead = async (chatId: string) => {\n    if (!currentUser) return;\n    \n    try {\n      // Bepaal het juiste pad om te updaten op basis van de structuur\n      const chatDoc = await getDoc(doc(db, 'chats', chatId));\n      if (!chatDoc.exists()) return;\n      \n      const chatData = chatDoc.data() as Chat;\n      \n      if (typeof chatData.unreadCount === 'number') {\n        // Als het een getal is, update naar 0\n        await updateDoc(doc(db, 'chats', chatId), {\n          unreadCount: 0\n        });\n      } else {\n        // Als het een object is, update alleen de huidige gebruiker's entry\n        await updateDoc(doc(db, 'chats', chatId), {\n          [`unreadCount.${currentUser.uid}`]: 0\n        });\n      }\n      \n      // Update ongelezen berichten voor huidige gebruiker\n      const messagesRef = collection(db, 'chats', chatId, 'messages');\n      const q = query(\n        messagesRef,\n        where('senderId', '!=', currentUser.uid),\n        where('read', '==', false)\n      );\n      \n      const unreadMessagesSnapshot = await getDocs(q);\n      \n      // Update elk ongelezen bericht\n      const batch = new Array<Promise<void>>();\n      unreadMessagesSnapshot.docs.forEach(doc => {\n        batch.push(\n          updateDoc(doc.ref, { read: true })\n        );\n      });\n      \n      await Promise.all(batch);\n    } catch (err) {\n      console.error('Fout bij het markeren van berichten als gelezen:', err);\n    }\n  };\n\n  // Functie om totaal aantal ongelezen berichten te krijgen\n  const getUnreadCount = () => {\n    if (!currentUser) return 0;\n    \n    return chats.reduce((total, chat) => {\n      let chatUnreadCount = 0;\n      \n      // Controleer of unreadCount een getal of een object is\n      if (typeof chat.unreadCount === 'number') {\n        chatUnreadCount = chat.unreadCount;\n      } else if (typeof chat.unreadCount === 'object' && chat.unreadCount !== null) {\n        chatUnreadCount = chat.unreadCount[currentUser.uid] || 0;\n      }\n      \n      return total + chatUnreadCount;\n    }, 0);\n  };\n\n  const value = {\n    chats,\n    activeChat,\n    messages,\n    loadingChats,\n    loadingMessages,\n    error,\n    sendMessage,\n    createNewChat,\n    setActiveChatById,\n    markChatAsRead,\n    getUnreadCount\n  };\n\n  return (\n    <MessageContext.Provider value={value}>\n      {children}\n    </MessageContext.Provider>\n  );\n}; ","import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { collection, doc, setDoc, deleteDoc, query, where, getDocs, documentId } from 'firebase/firestore';\nimport { db } from '../firebase/config';\nimport { useAuth } from './AuthContext';\n\n// Interface voor een favoriete vacature\nexport interface FavoriteJob {\n  id: string;\n  jobId: string;\n  userId: string;\n  createdAt: Date;\n  job?: {\n    id: string;\n    title: string;\n    company: string;\n    location: string;\n    salary?: string;\n  };\n}\n\ninterface FavoritesContextType {\n  favorites: FavoriteJob[];\n  loading: boolean;\n  error: Error | null;\n  addFavorite: (jobId: string, jobData: any) => Promise<void>;\n  removeFavorite: (jobId: string) => Promise<void>;\n  isFavorite: (jobId: string) => boolean;\n  refreshFavorites: () => Promise<void>;\n}\n\nconst FavoritesContext = createContext<FavoritesContextType | undefined>(undefined);\n\nexport const useFavorites = () => {\n  const context = useContext(FavoritesContext);\n  if (context === undefined) {\n    throw new Error('useFavorites moet binnen een FavoritesProvider gebruikt worden');\n  }\n  return context;\n};\n\ninterface FavoritesProviderProps {\n  children: ReactNode;\n}\n\nexport const FavoritesProvider: React.FC<FavoritesProviderProps> = ({ children }) => {\n  const [favorites, setFavorites] = useState<FavoriteJob[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { currentUser, userProfile } = useAuth();\n\n  // Haal favorieten op uit Firestore\n  const fetchFavorites = async () => {\n    if (!currentUser) {\n      setFavorites([]);\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const favoritesRef = collection(db, 'favorites');\n      const favoritesQuery = query(favoritesRef, where('userId', '==', currentUser.uid));\n      const querySnapshot = await getDocs(favoritesQuery);\n\n      const fetchedFavorites: FavoriteJob[] = [];\n      querySnapshot.forEach((doc) => {\n        const data = doc.data();\n        fetchedFavorites.push({\n          id: doc.id,\n          jobId: data.jobId,\n          userId: data.userId,\n          createdAt: data.createdAt?.toDate() || new Date(),\n          job: data.job || undefined\n        });\n      });\n\n      console.log(`${fetchedFavorites.length} favorieten geladen voor gebruiker ${currentUser.uid}`);\n      setFavorites(fetchedFavorites);\n    } catch (err) {\n      console.error('Fout bij ophalen favorieten:', err);\n      setError(err instanceof Error ? err : new Error('Onbekende fout bij ophalen favorieten'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Voeg een favoriet toe\n  const addFavorite = async (jobId: string, jobData: any) => {\n    if (!currentUser) {\n      throw new Error('Je moet ingelogd zijn om een vacature als favoriet te markeren');\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Maak een unieke ID voor het favoriet document (gebruiker_ID + vacature_ID)\n      const favoriteId = `${currentUser.uid}_${jobId}`;\n      const favoriteRef = doc(db, 'favorites', favoriteId);\n\n      // Sla basis vacature gegevens op met de favoriet voor snelle weergave\n      const favoriteData: Omit<FavoriteJob, 'id'> = {\n        jobId,\n        userId: currentUser.uid,\n        createdAt: new Date(),\n        job: {\n          id: jobId,\n          title: jobData.title || 'Onbekende functie',\n          company: jobData.company || 'Onbekend bedrijf',\n          location: jobData.location || 'Locatie onbekend',\n          salary: jobData.salary\n        }\n      };\n\n      // Update de lokale state alvast voor directe gebruikersfeedback\n      const newFavorite: FavoriteJob = { id: favoriteId, ...favoriteData };\n      setFavorites(prev => {\n        // Controleer of het item al bestaat om duplicaten te voorkomen\n        if (prev.some(fav => fav.jobId === jobId)) {\n          return prev;\n        }\n        return [...prev, newFavorite];\n      });\n\n      // Daarna pas updaten in Firestore\n      await setDoc(favoriteRef, favoriteData);\n      console.log(`Favoriet toegevoegd met ID: ${favoriteId}`);\n    } catch (err) {\n      console.error('Fout bij toevoegen favoriet:', err);\n      setError(err instanceof Error ? err : new Error('Onbekende fout bij toevoegen favoriet'));\n      // Bij een fout, haal de favorieten opnieuw op om de juiste state te krijgen\n      fetchFavorites();\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Verwijder een favoriet\n  const removeFavorite = async (jobId: string) => {\n    if (!currentUser) {\n      throw new Error('Je moet ingelogd zijn om een favoriet te verwijderen');\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Favoriet ID opbouwen\n      const favoriteId = `${currentUser.uid}_${jobId}`;\n      const favoriteRef = doc(db, 'favorites', favoriteId);\n\n      // Update lokale state direct voor snelle gebruikersfeedback\n      setFavorites(prev => prev.filter(fav => fav.jobId !== jobId));\n\n      // Daarna pas verwijderen uit Firestore\n      await deleteDoc(favoriteRef);\n      console.log(`Favoriet verwijderd met ID: ${favoriteId}`);\n    } catch (err) {\n      console.error('Fout bij verwijderen favoriet:', err);\n      setError(err instanceof Error ? err : new Error('Onbekende fout bij verwijderen favoriet'));\n      // Bij een fout, haal de favorieten opnieuw op om de juiste state te krijgen\n      fetchFavorites();\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Controleer of een vacature favoriet is\n  const isFavorite = (jobId: string): boolean => {\n    return favorites.some(fav => fav.jobId === jobId);\n  };\n\n  // Refresh favorieten\n  const refreshFavorites = async () => {\n    await fetchFavorites();\n  };\n\n  // Haal favorieten op wanneer de gebruiker verandert\n  useEffect(() => {\n    if (currentUser) {\n      console.log('Gebruiker aangemeld, favorieten ophalen...');\n      fetchFavorites();\n    } else {\n      console.log('Geen gebruiker, favorieten leegmaken');\n      setFavorites([]);\n    }\n  }, [currentUser]); // Voer opnieuw uit als de ingelogde gebruiker verandert\n\n  const value = {\n    favorites,\n    loading,\n    error,\n    addFavorite,\n    removeFavorite,\n    isFavorite,\n    refreshFavorites\n  };\n\n  return (\n    <FavoritesContext.Provider value={value}>\n      {children}\n    </FavoritesContext.Provider>\n  );\n}; ","import React from 'react';\nimport { Navigate, Outlet } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { UserRole, getUserRole, isJobSeeker, isRecruiter } from '../../types/user';\n\ninterface ProtectedRouteProps {\n  requiredRole?: UserRole;\n}\n\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({ requiredRole }) => {\n  const { currentUser, loading, userProfile } = useAuth();\n  \n  console.log(\"ProtectedRoute rendering\", { currentUser, loading, requiredRole, userProfile });\n  \n  // Als het nog aan het laden is, toon een laadscherm\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-primary-600\"></div>\n        <div className=\"ml-4\">Bezig met laden...</div>\n      </div>\n    );\n  }\n  \n  // Als er geen ingelogde gebruiker is, doorverwijzen naar login\n  if (!currentUser) {\n    return <Navigate to=\"/login\" replace />;\n  }\n  \n  // Als er geen profiel is, mag de gebruiker nog steeds naar het dashboard\n  // daar zal de ProfileRecoveryComponent worden getoond\n  if (!userProfile) {\n    // Als dit echter een rolspecifieke route is, doorverwijzen naar het algemene dashboard\n    if (requiredRole) {\n      return <Navigate to=\"/dashboard\" replace />;\n    }\n    // Anders doorgaan met render\n    return <Outlet />;\n  }\n  \n  // Als er een specifieke rol vereist is, controleer met onze helperfuncties\n  if (requiredRole) {\n    // Gebruik de helperfuncties om type-veilig te checken\n    const hasCorrectRole = \n      (requiredRole === 'werkzoekende' && isJobSeeker(userProfile)) || \n      (requiredRole === 'recruiter' && isRecruiter(userProfile));\n    \n    if (!hasCorrectRole) {\n      console.warn(`Gebruiker heeft niet de juiste rol. Vereist: ${requiredRole}, Actueel: ${getUserRole(userProfile)}`);\n      return <Navigate to=\"/dashboard\" replace />;\n    }\n  }\n  \n  // Anders, render de beveiligde content\n  return <Outlet />;\n};\n\nexport default ProtectedRoute; ","import React, { useEffect } from 'react';\nimport { Navigate, Outlet } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\n\nconst PublicRoute: React.FC = () => {\n  const { currentUser, loading } = useAuth();\n  \n  console.log(\"PublicRoute rendering\", { loading, currentUser });\n  \n  useEffect(() => {\n    console.log(\"PublicRoute effect\", { loading, currentUser });\n  }, [loading, currentUser]);\n  \n  // Als het nog aan het laden is, laat een laadscherm zien\n  if (loading) {\n    console.log(\"PublicRoute - Toont laadscherm\");\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-primary-600\"></div>\n        <div className=\"ml-4\">Bezig met laden...</div>\n      </div>\n    );\n  }\n  \n  // Als er een gebruiker is, stuur naar home (die zal doorverwijzen naar het passende dashboard)\n  if (currentUser) {\n    console.log(\"PublicRoute - Doorverwijzen naar home\");\n    return <Navigate to=\"/\" replace />;\n  }\n  \n  // Als er geen gebruiker is, laat de publieke route zien\n  console.log(\"PublicRoute - Toont publieke content\");\n  return <Outlet />;\n};\n\nexport default PublicRoute; ","import React, { useState, useEffect, Suspense, lazy } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate, Outlet } from 'react-router-dom';\nimport { AuthProvider, useAuth } from './contexts/AuthContext';\nimport { MessageProvider } from './contexts/MessageContext';\nimport { FavoritesProvider } from './contexts/FavoritesContext';\n\n// Lazy loaded pagina's\nconst Login = lazy(() => import('./pages/Login'));\nconst Register = lazy(() => import('./pages/Register'));\nconst ResetPassword = lazy(() => import('./pages/ResetPassword'));\nconst Landing = lazy(() => import('./pages/Landing'));\nconst About = lazy(() => import('./pages/About'));\nconst Candidates = lazy(() => import('./pages/Candidates'));\nconst CandidateProfile = lazy(() => import('./pages/CandidateProfile'));\nconst Jobs = lazy(() => import('./pages/Jobs'));\nconst JobDetail = lazy(() => import('./pages/JobDetail'));\nconst JobApplicationForm = lazy(() => import('./pages/JobApplication'));\nconst Messages = lazy(() => import('./pages/Messages'));\nconst Conversation = lazy(() => import('./pages/Conversation'));\nconst ScheduleMeeting = lazy(() => import('./pages/ScheduleMeeting'));\nconst Calendar = lazy(() => import('./pages/Calendar'));\nconst ApplicationDetail = lazy(() => import('./pages/ApplicationDetail'));\n\n// Dashboard routes (lazy loaded)\nconst DashboardRoutes = lazy(() => import('./routes/dashboardRoutes'));\n\n// Kleinere componenten die direct geladen kunnen worden\nimport Layout from './components/Layout';\nimport ProtectedRoute from './components/common/ProtectedRoute';\nimport PublicRoute from './components/common/PublicRoute';\n\n// Stijlen\nimport './styles/globals.css';\n\n// Placeholder componenten voor ontbrekende pagina's (deze zijn klein genoeg om niet lazy te laden)\nconst Applications = () => <div className=\"p-4\"><h1 className=\"text-2xl font-bold\">Applications</h1><p>Applications page</p></div>;\nconst SearchJobs = () => <div className=\"p-4\"><h1 className=\"text-2xl font-bold\">Search Jobs</h1><p>Search jobs page</p></div>;\nconst Settings = () => <div className=\"p-4\"><h1 className=\"text-2xl font-bold\">Settings</h1><p>Settings page</p></div>;\n\n// Loading component voor Suspense fallback\nconst Loading = () => (\n  <div className=\"flex justify-center items-center h-screen\">\n    <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\n    <div className=\"ml-4\">Bezig met laden...</div>\n  </div>\n);\n\n// Vereenvoudigde dashboard componenten voor debugging\nconst SimpleDashboard: React.FC = () => {\n  console.log(\"Rendering SimpleDashboard\");\n  return (\n    <div className=\"p-8\">\n      <h1 className=\"text-2xl font-bold mb-4\">Dashboard</h1>\n      <p>Als je dit kunt zien, werkt de rendering correct.</p>\n    </div>\n  );\n};\n\n// Debugger component\nconst AuthDebugger: React.FC = () => {\n  const { loading, currentUser, userProfile, authError } = useAuth();\n  \n  console.log(\"AuthDebugger rendering\", { loading, currentUser, userProfile, authError });\n  \n  return (\n    <div className=\"fixed bottom-0 right-0 bg-black bg-opacity-75 text-white p-2 text-xs\">\n      Loading: {loading ? \"Ja\" : \"Nee\"}<br />\n      User: {currentUser ? \"Aanwezig\" : \"Geen\"}<br />\n      Profile: {userProfile ? userProfile.role : \"Geen\"}<br />\n      Error: {authError ? authError.message : \"Geen\"}\n    </div>\n  );\n};\n\n// Redirect component die controleert op auth status en doorverwijst\nconst Redirect: React.FC = () => {\n  const { currentUser, loading } = useAuth();\n  \n  console.log(\"Redirect component rendering\", { loading, currentUser });\n  \n  // Als het nog aan het laden is, toon laadscherm\n  if (loading) {\n    return <Loading />;\n  }\n  \n  // Na laden: redirect naar dashboard als ingelogd, of naar login als niet ingelogd\n  return currentUser ? <Navigate to=\"/dashboard\" replace /> : <Navigate to=\"/login\" replace />;\n};\n\n// De AppContent component (intern, heeft toegang tot AuthContext)\nconst AppContent: React.FC = () => {\n  console.log(\"AppContent component rendering\");\n  const { userProfile, currentUser } = useAuth();\n  \n  // Configureer globale error handler om kritieke fouten af te vangen\n  useEffect(() => {\n    const handleGlobalError = (event: ErrorEvent) => {\n      console.error(\"Onafgehandelde fout opgevangen:\", event.error);\n    };\n    \n    window.addEventListener('error', handleGlobalError);\n    \n    return () => {\n      window.removeEventListener('error', handleGlobalError);\n    };\n  }, []);\n  \n  return (\n    <Router basename=\"/\">\n      <Suspense fallback={<Loading />}>\n        <Routes>\n          {/* Openbare routes */}\n          <Route path=\"/\" element={<Landing />} />\n          \n          {/* Publieke routes met PublicRoute bescherming */}\n          <Route element={<PublicRoute />}>\n            <Route path=\"/login\" element={<Login />} />\n            <Route path=\"/register\" element={<Register />} />\n            <Route path=\"/reset-password\" element={<ResetPassword />} />\n          </Route>\n          \n          {/* About route */}\n          <Route path=\"/about\" element={<About />} />\n          \n          {/* Vacatures routes - alleen toegankelijk voor werkzoekenden */}\n          <Route element={<ProtectedRoute requiredRole=\"jobseeker\" />}>\n            <Route path=\"/jobs\" element={<Jobs />} />\n            <Route path=\"/job/:jobId\" element={<JobDetail />} />\n          </Route>\n          \n          {/* Beschermde applicatie routes */}\n          <Route element={<ProtectedRoute />}>\n            <Route path=\"/job-application/:jobId\" element={<JobApplicationForm />} />\n          </Route>\n          \n          {/* Job applicant routes */}\n          <Route element={<ProtectedRoute requiredRole=\"jobseeker\" />}>\n            <Route path=\"/applications\" element={<Applications />} />\n            <Route path=\"/search-jobs\" element={<SearchJobs />} />\n          </Route>\n\n          {/* Recruiter specific routes */}\n          <Route element={<ProtectedRoute requiredRole=\"recruiter\" />}>\n            <Route path=\"/candidates\" element={<Candidates />} />\n            <Route path=\"/candidate/:id\" element={<CandidateProfile />} />\n            <Route path=\"/schedule-meeting\" element={<ScheduleMeeting />} />\n            <Route path=\"/schedule-meeting/:id\" element={<ScheduleMeeting />} />\n          </Route>\n\n          {/* Shared routes (accessible to both job seekers and recruiters) */}\n          <Route path=\"/messages\" element={<Messages />} />\n          <Route path=\"/messages/:conversationId\" element={<Conversation />} />\n          <Route path=\"/settings\" element={<Settings />} />\n          <Route path=\"/job/:id\" element={<JobDetail />} />\n          <Route path=\"/application/:id\" element={<ApplicationDetail />} />\n          <Route path=\"/calendar\" element={<Calendar />} />\n          <Route path=\"/agenda\" element={<Calendar />} />\n\n          {/* Redirect route (voor directe doorverwijzing naar dashboard/login) */}\n          <Route path=\"/redirect\" element={<Redirect />} />\n          \n          {/* Fallback route voor debugging */}\n          <Route path=\"/simple\" element={<SimpleDashboard />} />\n          \n          {/* Dashboard routes - nu lazy loaded met separate bundle */}\n          <Route path=\"/dashboard/*\" element={\n            <Suspense fallback={<Loading />}>\n              <DashboardRoutes userProfile={userProfile} currentUser={currentUser} />\n            </Suspense>\n          } />\n          \n          {/* Redirect onbekende routes naar home */}\n          <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n        </Routes>\n      </Suspense>\n      \n      {/* Debug overlay */}\n      <AuthDebugger />\n    </Router>\n  );\n};\n\n// De hoofdcomponent die de providers opzet (extern, heeft GEEN toegang tot AuthContext)\nconst App: React.FC = () => {\n  console.log(\"App component rendering\");\n  \n  return (\n    <AuthProvider>\n      <MessageProvider>\n        <FavoritesProvider>\n          <AppContent />\n        </FavoritesProvider>\n      </MessageProvider>\n    </AuthProvider>\n  );\n};\n\nexport default App; ","// We hoeven process.env niet meer te definiëren omdat het al in index.html is gedefinieerd\n// Dus verwijder die code en houd het simpel\n\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './styles/globals.css';\n// Nu we weten dat de minimale app werkt, kunnen we de App importeren\nimport App from './App';\n\nconsole.log('PitchPro/src/main.jsx initialisatie gestart');\n\nconst rootElement = document.getElementById('root');\nif (!rootElement) {\n  throw new Error('Geen \"root\" element gevonden in de DOM. Controleer je index.html bestand.');\n}\n\n// Maak eerst een ErrorBoundary component\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error('App rendering fout:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"p-8\">\n          <h1 className=\"text-2xl font-bold text-red-600\">Er is iets misgegaan</h1>\n          <p>Er is een fout opgetreden bij het renderen van de applicatie:</p>\n          <pre className=\"mt-4 p-4 bg-red-50 text-red-700 rounded overflow-auto\">\n            {this.state.error?.message || 'Onbekende fout'}\n          </pre>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// Rendert de echte App direct, nu we weten dat process.env werkt\nconst root = ReactDOM.createRoot(rootElement);\ntry {\n  console.log('App renderen...');\n  root.render(\n    <React.StrictMode>\n      <ErrorBoundary>\n        <App />\n      </ErrorBoundary>\n    </React.StrictMode>\n  );\n  console.log('App rendering verzonden naar ReactDOM');\n} catch (error) {\n  console.error('Fout bij renderen van App:', error);\n  document.getElementById('root').innerHTML = `\n    <div style=\"padding: 20px; color: red;\">\n      <h1>Fout bij laden</h1>\n      <p>${error.message}</p>\n    </div>\n  `;\n} "],"file":"assets/index-1iGq18Ep.js"}
import{d as ne,u as se,r as c,j as e,N as ie}from"./react-vendor-wqxTS4Az.js";import{getDoc as le,doc as re,collection as z,getDocs as oe,addDoc as G,Timestamp as k}from"./firebase-firestore-CCnivBKz.js";import{u as de,b as ce,d as T}from"./index-CZ_3UTiA.js";import{u as me}from"./form-vendor-Esn1dlm-.js";import{H as A}from"./Header-DRYO9ubW.js";import{F as B}from"./Footer-DQrHjGn4.js";import"./firebase-app-CzzSlWfx.js";const ve=()=>{const{id:b}=ne(),R=se(),{currentUser:D,userProfile:y}=de(),[r,N]=c.useState(null),[w,f]=c.useState(!0),[ue,u]=c.useState(null),[o,$]=c.useState(null),[H,O]=c.useState(!1),[j,E]=c.useState(""),[S,C]=c.useState([]),[F,I]=c.useState(!1),[m,v]=c.useState(new Date().getMonth()),[x,V]=c.useState(new Date().getFullYear());if(!ce(y))return e.jsx(ie,{to:"/dashboard"});const{register:d,handleSubmit:U,control:he,watch:L,formState:{errors:l},setValue:h,reset:Y}=me({defaultValues:{date:new Date,time:"10:00",endTime:"11:00",title:"",description:"",meetingType:"kennismaking",locationType:"online"}}),Z=L("locationType");c.useEffect(()=>{(async()=>{if(!b){f(!1);return}try{f(!0);const n=await le(re(T,"users",b));if(n.exists()){const i=n.data(),t={id:n.id,name:i.displayName||i.name||"Onbekende kandidaat",email:i.email,phoneNumber:i.phoneNumber};N(t),h("candidateId",t.id),h("candidateName",t.name),h("candidateEmail",t.email||"")}else u("Kandidaat niet gevonden")}catch(n){console.error("Error fetching candidate:",n),u("Er is een fout opgetreden bij het laden van de kandidaat")}finally{f(!1)}})()},[b,h]);const K=async()=>{if(j.trim())try{I(!0),u(null);const a=z(T,"users"),n=await oe(a),i=[];n.forEach(t=>{const s=t.data();if(s.role==="werkzoekende"||s.userType==="werkzoekende"||s.role==="jobseeker"||s.userType==="jobseeker"){const p=s.displayName||s.name||"",g=s.email||"";(p.toLowerCase().includes(j.toLowerCase())||g.toLowerCase().includes(j.toLowerCase()))&&i.push({id:t.id,name:p,email:g,phoneNumber:s.phoneNumber})}}),C(i),i.length===0&&u("Geen kandidaten gevonden met deze zoekopdracht")}catch(a){console.error("Fout bij zoeken kandidaten:",a),u("Er is een fout opgetreden bij het zoeken naar kandidaten")}finally{I(!1)}},P=a=>{N(a),h("candidateId",a.id),h("candidateName",a.name),h("candidateEmail",a.email||""),C([]),E("")},J=()=>{const a=L("candidateName"),n=L("candidateEmail");if(!a){u("Vul tenminste een naam in voor de kandidaat");return}N({id:"manual",name:a,email:n}),C([]),E("")},W=async a=>{if(!D)return;const n=a.candidateId||(r?r.id:null),i=a.candidateName||(r?r.name:null);if(!n&&!i){u("Selecteer een kandidaat of voeg handmatig een kandidaat toe");return}try{f(!0);const t=new Date(a.date),[s,p]=a.time.split(":").map(Number);t.setHours(s,p);const g=new Date(a.date),[M,ae]=a.endTime.split(":").map(Number);g.setHours(M,ae);let q=n;(n==="manual"||!n)&&(q=(await G(z(T,"users"),{displayName:i,email:a.candidateEmail||null,role:"werkzoekende",userType:"werkzoekende",createdAt:k.now(),createdBy:D.uid,isManuallyAdded:!0})).id);const te={candidateId:q,candidateName:i,candidateEmail:a.candidateEmail||null,recruiterId:D.uid,recruiterName:(y==null?void 0:y.displayName)||"Onbekende recruiter",title:a.title,description:a.description,meetingType:a.meetingType,locationType:a.locationType,location:a.locationType==="locatie"?a.location:null,meetingLink:a.locationType==="online"?a.meetingLink:null,dateTime:k.fromDate(t),endDateTime:k.fromDate(g),status:"gepland",createdAt:k.now()};await G(z(T,"meetings"),te),O(!0),setTimeout(()=>{R("/dashboard")},2e3),Y(a)}catch(t){console.error("Error creating meeting:",t);let s="Er is een fout opgetreden bij het plannen van de afspraak";t instanceof Error&&(console.error("Foutdetails:",t.message),t.message.includes("permission-denied")?s="Je hebt geen toestemming om afspraken te plannen. Controleer of je de juiste rechten hebt.":t.message.includes("network")&&(s="Er lijkt een netwerkprobleem te zijn. Controleer je internetverbinding en probeer het opnieuw.")),u(s)}finally{f(!1)}},_=(a,n)=>new Date(a,n+1,0).getDate(),Q=()=>{m===0?(v(11),V(x-1)):v(m-1)},X=()=>{m===11?(v(0),V(x+1)):v(m+1)},ee=()=>{const a=new Date(x,m,1).getDay(),n=_(x,m),i=[];for(let t=0;t<a;t++)i.push(e.jsx("div",{className:"h-12 border border-gray-200"},`empty-${t}`));for(let t=1;t<=n;t++){const s=new Date(x,m,t),p=new Date,g=p.getDate()===t&&p.getMonth()===m&&p.getFullYear()===x,M=(o==null?void 0:o.getDate())===t&&(o==null?void 0:o.getMonth())===m&&(o==null?void 0:o.getFullYear())===x;i.push(e.jsx("div",{onClick:()=>{$(s),h("date",s)},className:`h-12 flex items-center justify-center cursor-pointer hover:bg-primary-100 transition-colors
            ${g?"font-bold":""}
            ${M?"bg-primary-500 text-white hover:bg-primary-600":"bg-white"}
            border border-gray-200`,children:t},`day-${t}`))}return i};return w&&!r?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(A,{}),e.jsxs("div",{className:"container mx-auto px-4 py-32 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Bezig met laden..."})]}),e.jsx(B,{})]}):w&&b?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(A,{}),e.jsxs("div",{className:"container mx-auto px-4 py-32 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Bezig met laden..."})]}),e.jsx(B,{})]}):e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(A,{}),e.jsx("div",{className:"w-full bg-gradient-to-r from-primary-600 to-primary-800 text-white py-32 mb-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:"Afspraak plannen"}),e.jsx("p",{className:"text-xl text-center max-w-3xl mx-auto",children:r?`Plan een afspraak met ${r.name}`:"Plan een afspraak met een kandidaat"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("div",{className:"w-full md:w-1/2 bg-white rounded-lg shadow-md overflow-hidden mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Kandidaat selecteren"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Zoek een kandidaat"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:j,onChange:a=>E(a.target.value),placeholder:"Voer naam of e-mail in...",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"}),e.jsx("button",{type:"button",onClick:K,disabled:F,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:F?"Zoeken...":"Zoek"})]})]}),S.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Gevonden kandidaten"}),e.jsx("div",{className:"max-h-60 overflow-y-auto border rounded-md",children:S.map(a=>e.jsxs("div",{onClick:()=>P(a),className:"p-3 border-b hover:bg-gray-50 cursor-pointer flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.name}),a.email&&e.jsx("p",{className:"text-sm text-gray-600",children:a.email})]}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Selecteren"})]},a.id))})]}),j&&S.length===0&&!F&&e.jsx("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-yellow-800",children:"Geen kandidaten gevonden. Controleer de spelling of zoek op een andere naam of e-mail."})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("div",{className:"flex-grow border-t border-gray-300"}),e.jsx("span",{className:"flex-shrink mx-4 text-gray-600",children:"OF"}),e.jsx("div",{className:"flex-grow border-t border-gray-300"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Voeg handmatig een kandidaat toe"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"candidateName",children:"Naam kandidaat *"}),e.jsx("input",{id:"candidateName",...d("candidateName",{required:"Naam is verplicht"}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",placeholder:"Volledige naam"}),l.candidateName&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:l.candidateName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"candidateEmail",children:"E-mail kandidaat"}),e.jsx("input",{id:"candidateEmail",...d("candidateEmail",{pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Ongeldig e-mailadres"}}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"email",placeholder:"E-mailadres"}),l.candidateEmail&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:l.candidateEmail.message})]}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:J,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors",children:"Bevestig kandidaat"})})]}),r&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Geselecteerde kandidaat"}),e.jsx("p",{className:"text-xl font-bold",children:r.name}),r.email&&e.jsx("p",{className:"text-gray-600",children:r.email}),e.jsx("button",{type:"button",onClick:()=>N(null),className:"mt-2 text-red-600 hover:text-red-800 text-sm",children:"Verwijderen"})]})]})}),e.jsx("div",{className:"w-full md:w-1/2 bg-white rounded-lg shadow-md overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Datum selecteren"}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:Q,className:"p-2 rounded-full hover:bg-gray-200 transition-colors","aria-label":"Vorige maand",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"text-lg font-medium",children:new Date(x,m).toLocaleDateString("nl-NL",{month:"long",year:"numeric"})}),e.jsx("button",{onClick:X,className:"p-2 rounded-full hover:bg-gray-200 transition-colors","aria-label":"Volgende maand",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Zo","Ma","Di","Wo","Do","Vr","Za"].map(a=>e.jsx("div",{className:"h-10 flex items-center justify-center font-medium text-gray-600",children:a},a))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:ee()}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Geselecteerde datum"}),e.jsx("p",{className:"text-xl font-bold",children:o?o.toLocaleDateString("nl-NL",{weekday:"long",day:"numeric",month:"long",year:"numeric"}):"Geen datum geselecteerd"})]})]})}),e.jsx("div",{className:"w-full md:w-1/2 bg-white rounded-lg shadow-md overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Afspraak details"}),H?e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:"Afspraak succesvol gepland! Pagina wordt omgeleid..."}):e.jsxs("form",{onSubmit:U(W),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"title",children:"Titel afspraak *"}),e.jsx("input",{id:"title",...d("title",{required:"Titel is verplicht"}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",placeholder:"Bijv. Kennismakingsgesprek met [naam]"}),l.title&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:l.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"time",children:"Begintijd *"}),e.jsx("input",{id:"time",...d("time",{required:"Begintijd is verplicht"}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"time"}),l.time&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:l.time.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"endTime",children:"Eindtijd *"}),e.jsx("input",{id:"endTime",...d("endTime",{required:"Eindtijd is verplicht"}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"time"}),l.endTime&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:l.endTime.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"meetingType",children:"Type afspraak *"}),e.jsxs("select",{id:"meetingType",...d("meetingType",{required:!0}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[e.jsx("option",{value:"kennismaking",children:"Kennismakingsgesprek"}),e.jsx("option",{value:"sollicitatiegesprek",children:"Sollicitatiegesprek"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Locatie type *"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",...d("locationType"),value:"online",className:"form-radio"}),e.jsx("span",{className:"ml-2",children:"Online meeting"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",...d("locationType"),value:"locatie",className:"form-radio"}),e.jsx("span",{className:"ml-2",children:"Op locatie"})]})]})]}),Z==="online"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"meetingLink",children:"Meeting link"}),e.jsx("input",{id:"meetingLink",...d("meetingLink"),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",placeholder:"Bijv. https://meet.google.com/..."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"location",children:"Adres locatie *"}),e.jsx("input",{id:"location",...d("location",{required:Z==="locatie"?"Adres is verplicht voor afspraken op locatie":!1}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",placeholder:"Bijv. Hoofdstraat 1, 1234 AB Amsterdam"}),l.location&&e.jsx("p",{className:"text-red-500 text-xs italic mt-1",children:l.location.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"description",children:"Beschrijving"}),e.jsx("textarea",{id:"description",...d("description"),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",rows:4,placeholder:"Geef extra details over deze afspraak..."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{type:"button",onClick:()=>R(`/candidate/${b}`),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Annuleren"}),e.jsx("button",{type:"submit",disabled:w,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors disabled:opacity-50",children:w?"Bezig...":"Afspraak plannen"})]})]})]})})]})}),e.jsx(B,{})]})};export{ve as default};
//# sourceMappingURL=ScheduleMeeting-Br6x8YKk.js.map

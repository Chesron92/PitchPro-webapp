import{e as w,d as N,r as i,j as e}from"./react-vendor-BJ-6AA60.js";import{u as S,c as k}from"./index-CVvBu09D.js";import{S as p}from"./Spinner-DKMqWW3s.js";import"./firebase-firestore-CCnivBKz.js";import"./firebase-app-CzzSlWfx.js";const I=()=>{const{conversationId:n}=w(),{currentUser:s}=S(),c=N(),{activeChat:r,messages:o,loadingMessages:j,error:D,sendMessage:v,setActiveChatById:m,markChatAsRead:x}=k(),[l,h]=i.useState(""),f=i.useRef(null),g=i.useRef(null);i.useEffect(()=>{s||c("/login")},[s,c]),i.useEffect(()=>{n&&(m(n),x(n))},[n,m,x]),i.useEffect(()=>{var t;(t=f.current)==null||t.scrollIntoView({behavior:"smooth"})},[o]),i.useEffect(()=>{var t;r&&((t=g.current)==null||t.focus())},[o.length,r]);const y=async t=>{if(t.preventDefault(),!l.trim()||!r||!n)return;const a=l.trim();h("");try{await v(n,a)}catch(d){console.error("Fout bij het versturen van bericht:",d),h(a)}},b=t=>{if(!t)return"";const a=t.toDate(),d=new Date,u=new Date(d);return u.setDate(u.getDate()-1),a.toDateString()===d.toDateString()?a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):a.toDateString()===u.toDateString()?"Gisteren":a.toLocaleDateString()};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden max-w-4xl mx-auto min-h-[70vh] flex flex-col",children:!n||!r?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(p,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-gray-50 border-b flex items-center gap-3",children:[e.jsx("button",{onClick:()=>c("/messages"),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),r.otherUser.photoURL?e.jsx("img",{src:r.otherUser.photoURL,alt:r.otherUser.displayName,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-md font-medium text-gray-600",children:r.otherUser.displayName.substring(0,1).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold",children:r.otherUser.displayName}),e.jsx("p",{className:"text-sm text-gray-500",children:r.otherUser.role})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 min-h-[calc(70vh-8rem)]",children:[j?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(p,{})}):o.length===0?e.jsx("div",{className:"text-center text-gray-500 mt-10",children:"Geen berichten. Stuur een bericht om het gesprek te starten."}):o.map(t=>e.jsx("div",{className:`flex ${t.senderId===(s==null?void 0:s.uid)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-3 rounded-lg ${t.senderId===(s==null?void 0:s.uid)?"bg-blue-500 text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[e.jsx("p",{children:t.text}),e.jsxs("div",{className:`text-xs mt-1 ${t.senderId===(s==null?void 0:s.uid)?"text-blue-100":"text-gray-500"}`,children:[b(t.timestamp),t.senderId===(s==null?void 0:s.uid)&&e.jsx("span",{className:"ml-1",children:t.read?" â€¢ Gelezen":""})]})]})},t.id)),e.jsx("div",{ref:f})]}),e.jsx("form",{onSubmit:y,className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",ref:g,value:l,onChange:t=>h(t.target.value),placeholder:"Typ een bericht...",className:"flex-1 px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",disabled:!l.trim(),className:"bg-blue-500 text-white px-4 py-2 rounded-full disabled:opacity-50",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})})})})};export{I as default};
//# sourceMappingURL=Conversation-D82HCNX9.js.map
